# 《On Java 8》笔记

Java Concurrency in Practice（[Java并发编程实战](https://book.douban.com/subject/10484692/)）



## 前言

尽可能地使用简单和简短的示例，方便读者理解。而不强求引入解决实际问题的例子。因为我发现，相比解决某个实际问题，读者更乐于看到自己真正理解了示例的每个细节。或许我会因为这些“玩具示例”而被一些人所诟病，但我更愿意看到我的读者们因此能保持饶有兴趣地学习。







### 语言设计错误

> “承诺升级理论”：继续犯错误的成本由别人承担，而承认错误的成本由自己承担。
>
> -- 诺贝尔经济学奖得主约瑟夫·斯蒂格利茨（*Joseph Stiglitz*）



### 测试用例

Java 8  + Gradle

[OnJava8-Examples](https://github.com/BruceEckel/OnJava8-Examples)

[www.OnJava8.com](http://www.onjava8.com/)    原版电子书



## 二十三、注解

**元数据和源代码文件结合**

**注解可以生成描述符文件，甚至是新的类定义，并且有助于减轻编写“样板”代码的负担。**

注解是真正**语言层级的概念**。

- **@Override**： 
- **@Deprecated**：
- **@SuppressWarnings**：关闭不当的编译器警告信息。
- **@SafeVarargs**：
- **@FunctionalInterface**：

### 基本语法



## 二十四、并发编程

Brian Goetz 《Java Concurrency in Practice》

### 术语问题

并发、并行、多任务、多处理、多线程、分布式系统...

> Brian Goetz [From Concurrent to Parallel](https://www.youtube.com/watch?v=NsDE7E8sIdQ):
>
> 并发是关于正确有效地控制对共享资源的访问。
>
> 并行是使用额外的资源来更快地产生结果。

并发通常意味着“**不止一个任务正在执行中**”，而并行性几乎总是意味着“**不止一个任务同时执行**。”你可以立即看到这些定义的区别：并行也有不止一个任务“正在进行”。区别在于细节，究竟是**如何“执行”**发生的。此外，重叠：为并行编写的程序有时可以在单个处理器上运行，而一些并发编程系统可以利用多个处理器。

> 另一种定义：
>
> **并发** ：同时完成多个任务。在开始处理其他任务之前，当前任务不需要完成。并发解决了阻塞发生的问题。当任务无法进一步执行，直到外部环境发生变化时才会继续执行。最常见的例子是I/O，其中任务必须等待一些input（在这种情况下会被阻止）。这个问题产生在I/O密集型。
>
> **并行**：同时在多个地方完成多个任务。这解决了所谓的计算密集型问题，如果将程序分成多个部分并在不同的处理器上编辑不同的部分，程序可以运行得更快。



两个概念混淆的主要原因是包括Java在内的许多编程语言使用相同的机制**线程**来实现并发和并行。



#### 并发的新定义

**并发性是一系列性能技术，专注于减少<font color=#FF8C00>等待</font>**



### 并发的超能力

### 并发为速度而生

只有在显然没有其他选择时才开始使用并发，然后仅在孤立的地方。



### 四句格言

1. 不要这样做

2. 没有什么是真的，一切可能都有问题 

3. 它起作用,并不意味着它没有问题 

4. 你仍然必须理解它

了解并发性 使你意识到正确的程序可能会表现出错误的行为。

### 残酷的真相



### 并行流



### 创建和运行任务



### 终止耗时任务



### **CompletableFuture**类



### 死锁



### 构造函数非线程安全